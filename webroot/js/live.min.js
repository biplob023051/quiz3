!function(e){function t(){navigator.onLine?(u&&(a(),u=!1),e.isEmptyObject(d)||u||(clearInterval(l),n(0))):(e("#std_form_submit").text(lang_strings.disabled_submit).attr("disabled",!0),e("#confirmed").attr("disabled",!0),e(".no-internet").show())}function n(a){var i=d[a];e.ajax({dataType:"json",url:projectBaseUrl+"students/update_answer",type:"post",data:{question_id:i.question_id,text:i.answer_text,checkbox_record:i.checkbox_record,checkBoxDelete:i.checkBoxDelete,checkbox_record_delete:i.checkbox_record_delete,checkBox:i.checkBox,random_id:i.random_id,case_sensitive:i.case_sensitive},success:function(r){r.success?(e("#quest-"+i.question_id).removeClass("glyphicon-refresh spinning").addClass("glyphicon-ok-sign text-success"),++a<m?n(a):(m=0,d={},l=setInterval(t,1e3),s())):(alert("Something went wrong, please try now"),window.location.reload())}})}function s(){e(".no-internet").hide(),e("#std_form_submit").text(lang_strings.enabled_submit).attr("disabled",!1),e("#confirmed").attr("disabled",!1)}function a(){var t=e("#fname").val(),n=e("#lname").val(),s=e("#class").val();""==t&&""==n&&""==s||e.ajax({dataType:"json",url:projectBaseUrl+"students/update_student",type:"post",data:{fname:t,lname:n,class:s,random_id:random_id},success:function(a){a.success?(e("#studentId").attr("value",a.student_id),""!=t&&e("#std-fname").removeClass("glyphicon-refresh spinning").addClass("glyphicon-ok-sign text-success"),""!=n&&e("#std-lname").removeClass("glyphicon-refresh spinning").addClass("glyphicon-ok-sign text-success"),""!=s&&e("#std-class").removeClass("glyphicon-refresh spinning").addClass("glyphicon-ok-sign text-success"),e("#std_form_submit").text(lang_strings.enabled_submit).attr("disabled",!1)):(alert("Something went wrong, please try now"),window.location.reload())}})}function i(t){e("#std_form_submit").text(lang_strings.disabled_submit).attr("disabled",!0);var n=t.closest("tr").prev().val(),s=[],a="",i=1,o="",c="";t.is(":checkbox")&&(t.is(":checked")&&(i=""),c=t.attr("name"),e("input[name='"+c+"']").each(function(e){t.is(":checked")&&(s[e]=t.val())}),s.length<1&&(a=1),o=1),e("#quest-"+n).removeClass("glyphicon-ok-sign text-success").addClass("glyphicon-refresh spinning"),d[m]={question_id:n,case_sensitive:t.closest("tr").prev().attr("data-case"),answer_text:t.val(),checkbox_record:s,checkBoxDelete:a,checkbox_record_delete:i,checkBox:o,random_id:random_id},m++,r(t)}function r(e){var t=e.closest(".choices"),n=parseInt(t.prev().find(".max_allowed").text());isNaN(n)||(t.find('input[type="checkbox"]:checked').length>=n?(t.find('input[type="checkbox"]:not(:checked)').attr("disabled",!0),t.find('input[type="checkbox"]:not(:checked)').addClass("max_allowed_disabled")):(t.find('input[type="checkbox"]:not(:checked)').attr("disabled",!1),t.find('input[type="checkbox"]:not(:checked)').removeClass("max_allowed_disabled")))}function o(){return""==e("#fname").val()?(e("#error-message").show(),e("#error-message").html(lang_strings[5]),!0):""==e("#lname").val()?(e("#error-message").show(),e("#error-message").html(lang_strings[6]),!0):""==e("#class").val()&&(e("#error-message").show(),e("#error-message").html(lang_strings[7]),!0)}function c(){var t=/[a-zA-Z0-9]+/;return 0==t.test(e("#StudentFname").val())?(e("#error-message").show(),e("#error-message").html(lang_strings.first_name_invalid),!0):0==t.test(e("#StudentLname").val())?(e("#error-message").show(),e("#error-message").html(lang_strings.last_name_invalid),!0):0==t.test(e("#StudentClass").val())&&(e("#error-message").show(),e("#error-message").html(lang_strings.class_invalid),!0)}e(document).on("contextmenu",function(e){e.preventDefault(),alert(lang_strings.right_click_disabled)});var l,d={},u=!1,m=0;l=setInterval(t,1e3),e.fn.extend({doneTyping:function(t,n){n=n||2e3;var s,a=function(e){s&&(s=null,t.call(e))};return this.each(function(t,i){var r=e(i);r.is(":input")&&r.on("keyup keypress mouseup",function(e){s&&clearTimeout(s),s=setTimeout(function(){a(i)},n)}).on("blur",function(){s&&clearTimeout(s),a(i)})})}}),e("#fname").doneTyping(function(){e(this).parent().next().removeClass("glyphicon-ok-sign text-success").addClass("glyphicon-refresh spinning"),navigator.onLine?(e("#std_form_submit").text(lang_strings.disabled_submit).attr("disabled",!0),a()):u=!0}),e("#lname").doneTyping(function(){e(this).parent().next().removeClass("glyphicon-ok-sign text-success").addClass("glyphicon-refresh spinning"),navigator.onLine?(e("#std_form_submit").text(lang_strings.disabled_submit).attr("disabled",!0),a()):u=!0}),e("#class").doneTyping(function(){e(this).parent().next().removeClass("glyphicon-ok-sign text-success").addClass("glyphicon-refresh spinning"),navigator.onLine?(e("#std_form_submit").text(lang_strings.disabled_submit).attr("disabled",!0),a()):u=!0}),e(document).on("change",".tick-mark",function(){i(e(this))}),e(".typing").doneTyping(function(){i(e(this))}),e("#StudentLiveForm").submit(function(t){if(t.preventDefault(),navigator.onLine){e("#error-message").hide();var n=o();if(1==n)e("html, body").animate({scrollTop:e(".page-header").offset().top},500);else if(1==(n=c()))e("html, body").animate({scrollTop:e(".page-header").offset().top},500);else{var s=e("#confirm-submit"),a=[],i=0;e("#questions").find(".form-group :input").each(function(){if(i++,""==e(this).val()){var t=e(this).closest("tr").attr("id").match(/\d+/);a.push(t)}});var r=[];e("#questions").find(".radio :input").each(function(){-1!==jQuery.inArray(e(this).attr("name"),r)||r.push(e(this).attr("name"))}),r.length>0&&e.each(r,function(t,n){if(!e("input[name='"+n+"']:checked").val()){var s=e("input[name='"+n+"']").closest("tr").attr("id").match(/\d+/);a.push(s)}});var l=[];if(e("#questions").find(".checkbox :input").each(function(){-1!==jQuery.inArray(e(this).attr("name"),l)||l.push(e(this).attr("name"))}),l.length>0&&e.each(l,function(t,n){if(!e("input[name='"+n+"']:checked").val()){var s=e("input[name='"+n+"']").closest("tr").attr("id").match(/\d+/);a.push(s)}}),a.length>0){a.sort(function(e,t){return isNaN(e)||isNaN(t)?e>t?1:-1:e-t});d=a.join();d=lang_strings[2]+d+lang_strings[3]+lang_strings[4]}else var d=lang_strings[1];s.find(".modal-body").html(d),s.modal("show"),e(document).on("click","button#confirmed",function(){window.btn_clicked=!0,e("#StudentLiveForm").unbind("submit").submit()})}}else alert(lang_strings[0])})}(jQuery);